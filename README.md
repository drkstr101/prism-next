# prism-next

A demonstration of best practices for developing applications with pubsweet.

## Get Started

[![Open in Gitpod](https://gitpod.io/button/open-in-gitpod.svg)](https://gitpod.io/#https://github.com/drkstr101/prism-next)

Run `docker compose up --detach && yarn start` to launch all applications and services in development mode. Run `yarn build` to prepare a production release. Any build artifacts will be stored in the `dist/` directory, ready to be deployed. Other top-level tasks include: `format`, `lint`, `test`, and `e2e`.

## Background

### PubSweet

PubSweet is a free, open-source framework for building publishing platforms. It consists of an Express server and React client that work together, and both can be modified and extended with components to add functionality to the system. PubSweet is used for book publishing, academic journal production, and micropublication platforms by many established academic organizations, including the University of California Press, eLife, Hindawi, California Digital Library, and others.

#### Projects Using Pubsweet

- [Editoria](https://gitlab.coko.foundation/editoria/editoria) - a book production platform built for University of California Press
- [elife-xpub](https://github.com/elifesciences/elife-xpub/) - A journal publishing platform in collaboration with eLife
- [xpub-review](https://gitlab.com/hindawi/xpub/xpub-review) - A journal publishing platform in collaboration with Hindawi
- [Micropubs](https://gitlab.coko.foundation/micropubs/wormbase) - A micropublications platform in collaboration with Wormbase
- [Xpub](https://gitlab.coko.foundation/xpub/xpub) - Collabra, a journal publishing platform
- [Kotahi](https://gitlab.coko.foundation/kotahi/kotahi) - Document submission, review and publishing system

### Coko Client/Server

The original PubSweet framework was developed five years ago, and it is no longer actively maintained. This project is now actively developed and maintained under [Coko Client](https://gitlab.coko.foundation/cokoapps/client) and [Coko Server](https://gitlab.coko.foundation/cokoapps/server), collectively called the PubSweet FrameWork.

These projects are still under active development and depend on large portions of the original framework. Consequently, the current published documentation and starter projects are outdated. One must often refer to the source code to derive intended usage.

### Kotahi

Kotahi is a scholarly publishing platform based on PubSweet. It supports multiple customizable end-to-end workflows for journals, preprint, PRC, conference proceedings, submissions, reviews, communication, and publication. A complete list of features can be found on the [Kotahi homepage](https://kotahi.community/features/). Kotahi is still under active development and is primarily developed for and used by [eLife](https://elifesciences.org/), "an independent nonprofit committed to improving the way research is reviewed and communicated."

A sandbox Kotahi environment is up and running at <http://146-190-44-217.nip.io:4000/>. When signing in or registering, you will be prompted to select an ORCID sandbox user. If you do not have one already, you can create one during the registration flow, but ORCID will only send mail to a mailinator.com address in their sandbox environment. Click [here](https://www.mailinator.com/v4/public/inboxes.jsp?to=kotahi-aps-dev) to reserve <kotahi-aps-dev@mailinator.com> if needed.

## Features

### Monorepo Workspace

- [.prettierrc](./.prettierrc)
- [.eslintrc.json](./.eslintrc.json)
- [nx.json](./nx.json)
- [tsconfig.base.json](./tsconfig.base.json)
- [jest.config.ts](./jest.config.ts)
- [jest.presets.js](./jest.presets.js)
- `**/project.json`

### Docker Services

- [docker-compose.yml](./docker-compose.yml)

### GitHub Workflows

- [.github/workflows/ci.yml](./.github/workflows/ci.yml)
- [.github/workflows/e2e.yml](./.github/workflows/e2e.yml)

### VSCode Integration

- [.vscode/extensions.json](./.vscode/extensions.json)
- [.vscode/settings.json](./.vscode/settings.json)

### Yarn Berry

- [.yarnrc.yml](./.yarnrc.yml)
- [package.json](./package.json)

### GitPod Environment

- [.gitpod.yml](./.gitpod.yml)
- [Dockerfile.gitpod](./Dockerfile.gitpod)

### Global Config

- [config/custom-environment-variables.js](./config/custom-environment-variables.js)
- [config/default.js](./config/default.js)

### Cypress Application

See: [apps/cypress](./apps/cypress/README.md)

### Demo Application

See: [apps/demo](./apps/demo/README.md)

### Home Application

See: [apps/home](./apps/home/README.md)

### Server Application

See: [apps/server](./apps/server/README.md)

### Client Library

See: [libs/client](./libs/client/README.md)

### Database Library

See: [libs/db](./libs/db/README.md)

### UI Library

See: [libs/client](./libs/client/README.md)

## Nx Build System

✨ **This workspace has been generated by [Nx, a Smart, fast and extensible build system.](https://nx.dev)** ✨

### Start the app

To start the development server run `yarn nx serve home`. Open your browser and navigate to <http://localhost:4200/>. Happy coding!

### Generate code

If you happen to use Nx plugins, you can leverage code generators that might come with it.

Run `yarn nx list` to get a list of available plugins and whether they have generators. Then run `yarn nx list <plugin-name>` to see what generators are available.

Learn more about [Nx generators on the docs](https://nx.dev/plugin-features/use-code-generators).

### Running tasks

To execute tasks with Nx use the following syntax:

```shell
yarn nx <target> <project> <...options>
```

You can also run multiple targets:

```shell
yarn nx run-many -t <target1> <target2>
```

..or add `-p` to filter specific projects

```shell
yarn nx run-many -t <target1> <target2> -p <proj1> <proj2>
```

Targets can be defined in the `package.json` or `projects.json`. Learn more [in the docs](https://nx.dev/core-features/run-tasks).

### Want better Editor Integration?

Have a look at the [Nx Console extensions](https://nx.dev/nx-console). It provides autocomplete support, a UI for exploring and running tasks & generators, and more! Available for VSCode, IntelliJ and comes with a LSP for Vim users.
